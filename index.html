<!doctype html>
<meta charset="utf-8">
<title>Перемещение спрайта с помощью клавиатуры</title>
<canvas width="550" height="400" style="border: 1px dashed black">
</canvas>
var canvas = document.querySelector("canvas");
<script>
//--- Объект спрайта
var spriteObject =
{
	sourceX: 0,
	sourceY: 0,
	sourceWidth: 64,
	sourceHeight: 64,
	x: 0,
	y: 0,
	width: 64,
	height: 64,
	vx: 0,
	vy: 0
};
//--- Главная программа
//Холст и его поверхность рисования
var canvas = document.querySelector("canvas");
var drawingSurface = canvas.getContext("2d");
//Массив для хранения спрайтов
var sprites = [];
//Создание спрайта кошки и центрирование его
var cat = Object.create(spriteObject);
cat.x = 243;
cat.y = 168;
sprites.push(cat);
//Загрузка изображения спрайта
var image = new Image();
image.addEventListener("load", loadHandler, false);
image.src = "cat.png";
//Коды клавиш со стрелками
var UP = 38;
var DOWN = 40;
var RIGHT = 39;
var LEFT = 37;
//Направления движения
var moveUp = false;
var moveDown = false;
var moveRight = false;
var moveLeft = false;
//Обработчик событий нажатия клавиш клавиатуры
window.addEventListener("keydown", function(event)
{
	switch(event.keyCode)
	{
		case UP:
		moveUp = true;
		break;
		case DOWN:
		moveDown = true;
		break;
		case LEFT:
		moveLeft = true;
		break;
		case RIGHT:
		moveRight = true;
		break;
	}
}, false);
//Обработчик событий отпускания клавиш клавиатуры
window.addEventListener("keyup", function(event)
{
	 switch(event.keyCode)
	 {
		 case UP:
		 moveUp = false;
		 break;
		 case DOWN:
		 moveDown = false;
		 break;
		 case LEFT:
		 moveLeft = false;
		 break;
		 case RIGHT:
		 moveRight = false;
		 break;
	 }
}, false);
//Обработчик события завершения загрузки изображения
function loadHandler()
{
	update();
}
function update()
{
	//Цикл анимации
	requestAnimationFrame(update, canvas);
	//Вверх
	if(moveUp && !moveDown)
	{
		cat.vy = -5;
	}
	//Вниз
	if(moveDown && !moveUp)
	{
		cat.vy = 5;
	}
	//Налево
	if(moveLeft && !moveRight)
	{
		cat.vx = -5;
	}
	//Направо
	if(moveRight && !moveLeft)
	{
		cat.vx = 5;
	}
	//Если ни одна из клавиш не нажата, скорость перемещения равна 0
	if(!moveUp && !moveDown)
	{
		cat.vy = 0;
	}
	if(!moveLeft && !moveRight)
	{
		cat.vx = 0;
	}
	//Перемещение кошки
	cat.x += cat.vx;
	cat.y += cat.vy;
	//Остановка спрайта на границе холста
	if (cat.x < 0)
	{
		cat.x = 0;
	}
	if (cat.y < 0)
	{
		cat.y = 0;
	}
	if (cat.x + cat.width > canvas.width)
	{
		cat.x = canvas.width - cat.width;
	}
	if (cat.y + cat.height > canvas.height)
	{
		cat.y = canvas.height - cat.height;
	}

	//Отображение спрайта
	render();
}
function render()
{
	//Очистка холста: удаление предыдущего анимационного кадра
	drawingSurface.clearRect(0, 0, canvas.width, canvas.height);
	//Перебор спрайтов и использование их свойств для отображения
	if(sprites.length !== 0)
	{
		for(var i = 0; i < sprites.length; i++)
		{
			var sprite = sprites[i];
			drawingSurface.drawImage(image,
			sprite.sourceX, sprite.sourceY,
			sprite.sourceWidth, sprite.sourceHeight,
			Math.floor(sprite.x), Math.floor(sprite.y),
			sprite.width, sprite.height);
		}
	}
}
</script>
